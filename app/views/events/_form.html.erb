<%= simple_form_for(@event) do |f| %>
<div class="form-actions">
  <%= hidden_field_tag :calendar_day_id, params[:calendar_day_id] %>
  <%= f.input :calendar_day_id, :as => "hidden"%>
  <b>Dia:</b> <%= @event.calendar_day.to_string %><br>
</div>
<div class="row-fluid">
  <div class="span3"><%= f.input :time_start, input_html: { class: 'span3' } %></div>
  <div class="span3"><%= f.input :time_end, input_html: { class: 'span3' } %></div>
</div>
<div class="row-fluid">
  <div class="span3"><%= f.input :type_event, collection: TypeEvent %></div>
</div>
<div class="row-fluid">
  <div class="span6">
      <%= f.input :description, input_html: { rows: 10 } %>
    </div>
</div>

<div class="row-fluid">
  <div class="span3"><%= f.input :closed %></div>
</div>
<br>
<div class="<%= 'hidden' unless f.object.monitoring? %>" id="div_monitoring" >
  <blockquote>
    <h3>Monitoria</h3>
    <div class='row-fluid' >
      <div class="span10"><%= f.input :student_id, collection: Student.sorted, input_html: { class: 'span10' } %></div>
    </div>
    <div class='row-fluid' >
      <div class="span10"><%= f.input :teacher_id, collection: current_company.teachers.monitor.map{|cd|[cd.to_s_monitor, cd.id]}, input_html: { class: 'span10' } %></div>
    </div>

		<div class="alert alert-info">
			<button type="button" class="close" data-dismiss="alert">&times;</button>
			<i class="icon-time"></i><strong>Horários Monitoria</strong><br>
			<% ScheduleTeacher.all.group_by(&:teacher).each do |teacher, schedules| %>
				<br><strong><%= teacher %></strong><br>
				<% schedules.sort_by(&:day_week).each do |s| %>
					<%= s.day_week_humanize %> <%= s.time_start.try(:strftime, '%H:%M')%> às <%= s.time_end.try(:strftime, '%H:%M')%><br>
				<% end %>
			<% end %>
		</div>
  </blockquote>
</div>
<blockquote>
	<div class="alert alert-info">
		<button type="button" class="close" data-dismiss="alert">&times;</button>
		<i class="icon-file"></i><strong>Histórico</strong><br>
		<% @event.calendar_day.events.each do |e|  %>
			<%= e.time_start.try(:strftime, '%H:%M') %> às  <%= e.time_end.try(:strftime, '%H:%M') %> <%= e.description %><%= " - #{e.student}" if e.monitoring? %><br>
		<% end %>
		<% @event.calendar_day.schedules.each do |s|  %>
			<%= s.description%>(<%= s.plan %> - cronograma) <br>
		<% end %>	
	</div>
</blockquote>
<div class="form-actions">
  <%= f.button :submit, :class => "btn btn-success" %>
  <%= link_to 'Voltar', calendar_path(id: @event.calendar_day.calendar, calendar_day_id: @event.calendar_day_id ), class: 'btn' %>
</div>

<% end %>
